---
title: EXCEL常用公式
date: 2022-04-15 15:22:46.928
updated: 2022-04-15 15:24:26.89
url: /archives/excel-chang-yong-gong-shi
categories: 
tags: 
---

#### 1. 自动算生日
公式：
```
=TEXT(MID(身份证号码所在单元格,7,8),"0000-00-00")
```
END
#### 2.自动算年龄
在目标单元格输入公式 
```
=2020-MID(E2,7,4)。
```
E2是目标单元格；
7是身份证号码从左数起第7位；
4是身份证号码第7位数起右边4个数字。
如果需要精确到当日，计算到足龄周岁，则在目标单元格输入 
```
=DATEDIF(TEXT(MID(E2,7,8),"00-00-00"),TODAY(),"Y")
```
精确到某个日期计算周岁
```
=DATEDIF(TEXT(MID(E2,7,LEN(E2)/2-1),"0-00-00"),"2017-12-31","Y")
```
E2是目标单元格
#### 3.自动算性别
公式：
```
=IF(MOD(MID(身份证号码所在单元格,15,3),2),"男","女")
```
END
#### 4.自动算星座
公式：
```
=CHOOSE(MATCH(TRUE,MID(身份证号码所在单元格,11,2)&"月"&MID(身份证号码所在单元格,13,2)&"日">={"12月22日","11月22日","10月23日","09月23日","08月23日","07月23日","06月22日","05月21日","04月21日","03月21日","02月19日","01月20日","01月01日"},),"摩羯座","射手座","天蝎座","天秤座","处女座","狮子座","巨蟹座","双子座","金牛座","白羊座","双鱼座","水瓶座","摩羯座")
```
#### 5.自动算出生地（籍贯）
公式：
```
=VLOOKUP(VALUE(LEFT(身份证号码所在单元格,6)),出生地查询表!B:C,2,1)
```
#### 6.导入数据
公式：
```
=VLOOKUP(查找值,查找表格左上角，右下角,第几项,FALSE)
```
#### 7.不显示错误
公式：
```
=if(iserror(原公式),"",原公式)
```